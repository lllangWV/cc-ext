---
description: Generate implementation loop scripts for continuous autonomous coding (Linear-free)
---

# Create Ralph Implementation Loop

Generate an implementation loop that uses GitHub issues and specs (no Linear integration).

## Arguments

- `$1` = Model (default: `sonnet`, options: `sonnet`, `opus`, `haiku`)
- `$2` = Output directory (default: `scripts/`)

## Process

### Step 1: Create Output Directory

Create the output directory if it doesn't exist:
```bash
mkdir -p "${2:-scripts}"
```

### Step 2: Generate IMPL_LOOP_PROMPT.md

Use the Write tool to create `${2:-scripts}/IMPL_LOOP_PROMPT.md` with this content:

```markdown
# Implementation Loop

## Configuration

Check for `impl.conf.json` in the project root or `scripts/` directory for project-specific settings.

Defaults:
- Specs file: `specs/README.md`, `SPEC.md`, or `README.md`
- Source directories: `src/`, `lib/`, or root
- Issues directory: `known-issues/`
- Plan file: `IMPLEMENTATION_PLAN.md`

## Pre-flight: Sync GitHub Issues

-1a. Detect the GitHub repository from git remote:
\`\`\`bash
GITHUB_REPO=$(git remote get-url origin 2>/dev/null | sed -E 's|.*github\.com[:/]([^/]+/[^/.]+)(\.git)?|\1|')
echo "Detected repo: $GITHUB_REPO"
\`\`\`

-1b. List open issues and compare with known-issues/:
\`\`\`bash
curl -s "https://api.github.com/repos/$GITHUB_REPO/issues?state=open" | jq -r '.[].number'
ls known-issues/ 2>/dev/null || mkdir -p known-issues/
\`\`\`

-1c. For any issues on GitHub not in known-issues/, fetch and save:
\`\`\`bash
# Replace N with issue number
curl -s "https://api.github.com/repos/$GITHUB_REPO/issues/N" | \
  jq -r '"# \(.title)\n\n**Issue:** [#\(.number)](\(.html_url))\n**Author:** \(.user.login)\n**Created:** \(.created_at[:10])\n**State:** \(.state)\n\n\(.body)"' \
  > known-issues/issue-N.md
\`\`\`

-1d. Read any new issues in known-issues/ and incorporate them into IMPLEMENTATION_PLAN.md

## Phase 0: Context Gathering

0a. Read project specifications:
    - Check for `specs/README.md`, `SPEC.md`, or main `README.md`
    - Check for `CLAUDE.md` for build/test commands

0b. Read `IMPLEMENTATION_PLAN.md` if it exists

0c. Familiarize yourself with the source code structure using subagents

## Phase 1: Implementation

1. Read IMPLEMENTATION_PLAN.md and implement the **single highest priority feature** using up to 5 subagents
   - Include anything in "out of scope / future work" - that's now in scope!

2. After implementing, run verification commands:
   - Check CLAUDE.md or project config files (package.json, pyproject.toml, Makefile) for commands
   - Run: typechecking, testing, linting (as applicable)
   - Ensure all checks pass

3. Update IMPLEMENTATION_PLAN.md with your progress

4. Commit your changes:
\`\`\`bash
git add -A && git commit -m "..."  # do not include claude attribution
\`\`\`

## Important Guidelines

1. **Keep IMPLEMENTATION_PLAN.md updated** - use a subagent to update it after each feature, especially marking items complete

2. **Update CLAUDE.md** when you learn new build/test commands (keep it brief and focused)

3. **Document bugs** in IMPLEMENTATION_PLAN.md even if unrelated to current work

4. **Full implementations only** - no placeholders or minimal implementations

5. **Clean up periodically** - when IMPLEMENTATION_PLAN.md gets large, remove completed items using a subagent

6. **Avoid exploring generated directories**:
   - `.pixi/`, `.venv/`, `node_modules/`
   - `.pytest_cache/`, `.ruff_cache/`, `__pycache__/`
   - `.devcontainer/`, `.config/`
```

### Step 3: Generate run_impl_loop.sh

Use the Write tool to create `${2:-scripts}/run_impl_loop.sh` with this content (substitute MODEL with `$1` or default to `sonnet`):

```bash
#!/bin/bash
# Implementation loop - runs IMPL_LOOP_PROMPT.md through Claude in an infinite loop
# Generated by /create_ralph_impl_loop
#
# Usage: ./run_impl_loop.sh [model]
#   model: sonnet (default), opus, or haiku

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
BRANCH=$(git rev-parse --abbrev-ref HEAD)
MODEL="${1:-MODEL_PLACEHOLDER}"

echo "Starting implementation loop..."
echo "  Branch: $BRANCH"
echo "  Model: $MODEL"
echo "  Press Ctrl+C to stop"
echo ""

while true; do
    cat "$SCRIPT_DIR/IMPL_LOOP_PROMPT.md" | claude -p \
        --dangerously-skip-permissions \
        --output-format=stream-json \
        --model "$MODEL" \
        --verbose \
        | bunx repomirror visualize

    git push origin "$BRANCH"

    echo -e "\n\n======================== LOOP COMPLETE ========================\n\n"
done
```

Replace `MODEL_PLACEHOLDER` with the value from `$1` (or `sonnet` if not provided).

### Step 4: Make Script Executable

```bash
chmod +x "${2:-scripts}/run_impl_loop.sh"
```

### Step 5: Create Starter IMPLEMENTATION_PLAN.md (if missing)

Check if `IMPLEMENTATION_PLAN.md` exists in the project root. If not, create it:

```markdown
# Implementation Plan

## Priority Items

- [ ] (Add your first implementation task here)

## Completed

(Completed items will be moved here)

## Out of Scope / Future Work

(Items for later consideration)
```

### Step 6: Output Success Message

Output the following to the user:

```
Implementation loop created successfully!

Files generated:
  - ${2:-scripts}/IMPL_LOOP_PROMPT.md (editable prompt)
  - ${2:-scripts}/run_impl_loop.sh (loop runner)

Before running:
1. Create or update IMPLEMENTATION_PLAN.md with your tasks
2. Ensure CLAUDE.md has your build/test commands
3. Optionally create specs/README.md with project specifications

To start the loop:
  ./scripts/run_impl_loop.sh

To use a different model:
  ./scripts/run_impl_loop.sh opus
  ./scripts/run_impl_loop.sh haiku

The loop will:
  - Sync GitHub issues to known-issues/
  - Read specs and IMPLEMENTATION_PLAN.md
  - Implement the highest priority feature
  - Run tests and commit changes
  - Push to origin and repeat
```
